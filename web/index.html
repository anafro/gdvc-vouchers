<!DOCTYPE html>
<html lang="en">
<head>
    <script type="text/javascript" src="/eel.js"></script>
    <script src="main.js"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=PT+Sans:ital,wght@0,400;0,700;1,400;1,700&display=swap" rel="stylesheet">
    <meta charset="UTF-8">
    <link rel="stylesheet" href="styles.css">
    <title>–°–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç—ã –ì–∞—Ä–∞–Ω—Ç–∞</title>
</head>
<body>
    <div id="app" x-data="app()" x-init="init()" x-cloak>
        <form id="certificate-creation" x-show="open">
            <div id="certificate-creation__header">
                <h2 id="certificate-creation__title">–°–æ–∑–¥–∞—Ç—å —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç</h2>
                <a id="certificate-creation__close-button" x-on:click="open = false">
                    <img id="certificate-creation__close-button-icon" src="images/cross.svg" alt="x">
                </a>
            </div>

            <div id="certificate-creation__fields" x-on:submit="void(0)">
                <h2>–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –≤–ª–∞–¥–µ–ª—å—Ü–µ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–∞</h2>

                <input x-model="holder" type="text" id="certificate-creation__holder" placeholder="–§–ò–û –¥–µ—Ä–∂–∞—Ç–µ–ª—è —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–∞" pattern="(.|\s)*\S(.|\s)*">
                <input x-model="phone" type="text" id="certificate-creation__phone" placeholder="–ï–≥–æ –Ω–æ–º–µ—Ä —Ç–µ–ª–µ—Ñ–æ–Ω–∞" pattern="(^8|7|\+7)((\d{10})|(\s\(\d{3}\)\s\d{3}\s\d{2}\s\d{2}))">

                <h2>–¶–µ–Ω–Ω–æ—Å—Ç—å —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–∞ –∏ —É—Å–ª—É–≥–∞ –≤–æ–∑–º–æ–∂–Ω–æ–≥–æ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è</h2>

                <div id="certificate-creation__service-set">
                    <div class="certificate-creation__service-container">
                        <input x-model="service" type="radio" name="service" class="certificate-creation__service" id="certificate-creation__service-dry-cleaning" value="dry-cleaning" checked>
                        <label for="certificate-creation__service-dry-cleaning" class="certificate-creation__service-label">–•–∏–º—á–∏—Å—Ç–∫–∞ –º—è–≥–∫–æ–π –º–µ–±–µ–ª–∏ –∏ –∫–æ–≤—Ä–æ–≤, 500 —Ä—É–±–ª–µ–π</label>
                    </div>

                    <div class="certificate-creation__service-container">
                        <input x-model="service" type="radio" name="service" class="certificate-creation__service" id="certificate-creation__service-spring-cleaning" value="spring-cleaning" checked>
                        <label for="certificate-creation__service-spring-cleaning" class="certificate-creation__service-label">–ì–µ–Ω–µ—Ä–∞–ª—å–Ω–∞—è —É–±–æ—Ä–∫–∞, 1 000 —Ä—É–±–ª–µ–π</label>
                    </div>
                 </div>
            </div>

            <footer id="certificate-creation__footer">
                <button id="certificate-creation__submit" type="submit" x-on:click.prevent="await createCertificate(holder, phone, service); open = false; holder = ''; phone = ''; service = 'dry-cleaning'; certificates = await getCertificates()">–°–æ–∑–¥–∞—Ç—å –Ω–æ–≤—ã–π —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç</button>
            </footer>
        </form>

        <header>
        <div id="header__logo">
            <img id="header__logo-image" src="images/logotype.svg" alt="‚≠ê">
            <h1 id="header__logo-title">
                –°–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç—ã<br>
                –ö–ª–∏–Ω–∏–Ω–≥–∞
            </h1>
        </div>

        <div id="header__search">
            <img src="images/search.svg" alt="üîç" id="header__search-icon">
            <input id="header__search-input" type="search" placeholder="–ù–æ–º–µ—Ä —Ç–µ–ª–µ—Ñ–æ–Ω–∞, –§–ò–û –∏–ª–∏ –Ω–æ–º–µ—Ä —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–∞..." x-model="searchQuery" />
        </div>

        <a id="header__add-button">
            <img src="images/add.svg" alt="+" id="header__add-button-icon" x-on:click="open = true">
        </a>
    </header>

        <section id="certificates">
            <template x-for="certificate in filteredCertificates">
                <div class="certificates__card" x-data="{isCertificateOptionsOpen: false}">
                    <div class="certificates__card-header">
                        <dialog class="certificates__card-options-dialog" x-ref="certificateOptions">
                            <div class="certificates__card-options-dialog-header">
                                <h2 class="certificates__card-options-dialog-title">–ß—Ç–æ –í—ã —Ö–æ—Ç–∏—Ç–µ —Å–¥–µ–ª–∞—Ç—å?</h2>
                                <img src="images/cross.svg" alt="x" class="certificates__card-options-dialog-close-button" x-on:click="$refs.certificateOptions.close()">
                            </div>

                            <div class="certificates__card-options-dialog-option" x-on:click="deleteCertificate(certificate.id); $refs.certificateOptions.close(); certificates = await getCertificates()">
                                <img src="images/check.svg" alt="‚úîÔ∏è">
                                <span>–ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç (–µ—Å–ª–∏ –∫–ª–∏–µ–Ω—Ç –ø—Ä–∏—à—ë–ª –∏ —Ö–æ—á–µ—Ç –ø–æ–ª—É—á–∏—Ç—å —Å–∫–∏–¥–∫—É)</span>
                            </div>

                            <div class="certificates__card-options-dialog-option" x-on:click="deleteCertificate(certificate.id); $refs.certificateOptions.close(); certificates = await getCertificates()">
                                <img src="images/bin.svg" alt="üóëÔ∏è">
                                <span>–£–¥–∞–ª–∏—Ç—å —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç (–µ—Å–ª–∏ –∫—Ç–æ-—Ç–æ –∏–∑ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤ —Å–æ–∑–¥–∞–ª —ç—Ç–æ—Ç —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç —Å–ª—É—á–∞–π–Ω–æ)</span>
                            </div>

                            <div class="certificates__card-options-dialog-option" x-on:click="alert('TODO' /* TODO */)">
                                <img src="images/copy.svg" alt="üìÉ">
                                <span>–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –∫–∞—Ä—Ç–∏–Ω–∫—É —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–∞ –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</span>
                            </div>
                        </dialog>

                        <span class="certificates__card-id" x-text="'#' + certificate.id"></span>
                        <a class="certificates__card-options-button" x-on:click="$refs.certificateOptions.showModal()">
                            <img src="images/options.svg" alt="..." class="certificates__card-options-button-icon">
                        </a>
                    </div>

                    <h2 class="certificates__card-holder" x-text="certificate.holder"></h2>
                    <span class="certificates__card-phone" x-text="certificate.phone"></span>
                    <span class="certificates__card-service" x-text="certificate.service"></span>
                    <span class="certificates__card-value" x-text="`${certificate.value} —Ä—É–±–ª–µ–π`"></span>
                    <span class="certificates__card-expire-date" x-text="'–≠—Ç–∏–º —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–æ–º –º–æ–∂–Ω–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è –¥–æ ' + new Date(certificate.expires).toLocaleDateString('ru-RU', {
                        day: 'numeric',
                        month: 'long',
                        year: 'numeric'
                    })"></span>
                </div>
            </template>
        </section>
    </div>

    <script src="//unpkg.com/alpinejs" defer></script>
</body>
</html>